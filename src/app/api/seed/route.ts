import { NextResponse } from 'next/server';
import { connectToDatabase } from '@/lib/mongodb';
import Tool from '@/models/Tool';

const seedTools = [
  {
    name: 'ChatGPT',
    link: 'https://chat.openai.com',
    logo: 'ğŸ¤–',
    description: '××•×“×œ ×©×¤×” ××ª×§×“× ×œ×›×ª×™×‘×”, ×ª×›× ×•×Ÿ ×©×™×¢×•×¨×™× ×•×™×¦×™×¨×ª ×ª×•×›×Ÿ ×—×™× ×•×›×™. ×™×›×•×œ ×œ×¢×–×•×¨ ×‘××’×•×•×Ÿ ××©×™××•×ª ×›××• ×›×ª×™×‘×ª ×©××œ×•×ª, ×”×¡×‘×¨ ××•×©×’×™×, ×™×¦×™×¨×ª ×ª×¨×’×™×œ×™× ×•×¢×•×“.',
    limitations: '××•×’×‘×œ ×œ× ×ª×•× ×™× ×¢×“ ××¤×¨×™×œ 2024, ×œ× ×ª××™×“ ××“×•×™×§, ×“×•×¨×© ×‘×“×™×§×” ×©×œ ×”×ª×•×›×Ÿ ×©× ×•×¦×¨',
    advantages: '×§×œ ×œ×©×™××•×©, ×ª×•×¦××•×ª ××™×›×•×ª×™×•×ª, ××’×•×•×Ÿ ×¨×—×‘ ×©×œ ×™×›×•×œ×•×ª, ×–××™×Ÿ 24/7',
    disadvantages: '×“×•×¨×© ×× ×•×™ ×‘×’×¨×¡×” ×”××ª×§×“××ª, ×œ× ×ª××™×“ ××“×•×™×§, ×™×›×•×œ ×œ×”××¦×™× ××™×“×¢',
    usageInTeaching: '×™×¦×™×¨×ª ×©××œ×•×ª ×‘×—×™× ×”, ×”×›× ×ª ×—×•××¨×™ ×œ×™××•×“, ×”×¡×‘×¨ ××•×©×’×™× ××•×¨×›×‘×™×, ×™×¦×™×¨×ª ×ª×¨×’×™×œ×™× ××•×ª×××™×',
    toolRating: 4.5,
    difficultyLevel: '×‘×™× ×•× ×™',
    hebrewSupport: true,
    isFree: false,
    outputType: '×˜×§×¡×˜',
    communicationFormat: '×¦\'××˜ ××™× ×˜×¨××§×˜×™×‘×™',
    tags: ['×›×ª×™×‘×”', '×ª×›× ×•×Ÿ ×©×™×¢×•×¨×™×', '×©××œ×•×ª', '×”×¡×‘×¨', '×™×¦×™×¨×ª ×ª×•×›×Ÿ'],
    pedagogicalContext: ['×”×§× ×™×”', '×ª×¨×’×•×œ', '×”×¢×¨×›×”'],
    createdBy: 'system'
  },
  {
    name: 'Canva AI',
    link: 'https://www.canva.com',
    logo: 'ğŸ¨',
    description: '×›×œ×™ ×¢×™×¦×•×‘ ×’×¨×¤×™ ×¢× ×™×›×•×œ×•×ª ×‘×™× ×” ××œ××›×•×ª×™×ª ×œ×™×¦×™×¨×ª ×—×•××¨×™ ×œ×™××•×“ ×•×™×–×•××œ×™×™×, ×¤×•×¡×˜×¨×™×, ××¦×’×•×ª ×•×¢×•×“.',
    limitations: '××¤×©×¨×•×™×•×ª ××•×’×‘×œ×•×ª ×‘×’×¨×¡×” ×”×—×™× ××™×ª, ×“×•×¨×© ×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜, ×ª×œ×•×™ ×‘×ª×‘× ×™×•×ª ×§×™×™××•×ª',
    advantages: '×××©×§ ×™×“×™×“×•×ª×™, ×ª×‘× ×™×•×ª ×¨×‘×•×ª, ×™×¦×™×¨×” ××”×™×¨×”, ××™×›×•×ª ×’×¨×¤×™×ª ×’×‘×•×”×”',
    disadvantages: '××•×’×‘×œ ×œ×ª×‘× ×™×•×ª ×§×™×™××•×ª, ×“×•×¨×© ×× ×•×™ ×œ×ª×›×•× ×•×ª ××ª×§×“××•×ª, ×œ× ×ª××™×“ ××ª××™× ×œ×¢×‘×¨×™×ª',
    usageInTeaching: '×™×¦×™×¨×ª ×¤×•×¡×˜×¨×™× ×—×™× ×•×›×™×™×, ×¢×™×¦×•×‘ ××¦×’×•×ª, ×™×¦×™×¨×ª ××™× ×¤×•×’×¨×¤×™×§×”, ×—×•××¨×™ ×œ×™××•×“ ×•×™×–×•××œ×™×™×',
    toolRating: 4.2,
    difficultyLevel: '×§×œ',
    hebrewSupport: true,
    isFree: true,
    outputType: '×ª××•× ×”, ××¦×’×ª, ×•×™×“××•',
    communicationFormat: '×××©×§ ×’×¨×¤×™',
    tags: ['×¢×™×¦×•×‘', '×•×™×–×•××œ×™', '×¤×•×¡×˜×¨×™×', '××¦×’×•×ª', '××™× ×¤×•×’×¨×¤×™×§×”'],
    pedagogicalContext: ['×”×§× ×™×”'],
    createdBy: 'system'
  },
  {
    name: 'Kahoot AI',
    link: 'https://kahoot.com',
    logo: 'ğŸ¯',
    description: '×¤×œ×˜×¤×•×¨××” ×œ×™×¦×™×¨×ª ×—×™×“×•× ×™× ××™× ×˜×¨××§×˜×™×‘×™×™× ×¢× ×‘×™× ×” ××œ××›×•×ª×™×ª ×©××™×™×¦×¨×ª ×©××œ×•×ª ××•×˜×•××˜×™×ª ××ª×•×›×Ÿ × ×ª×•×Ÿ.',
    limitations: '××•×’×‘×œ ×œ×¤×•×¨××˜ ×©××œ×•×ª ×¡×’×•×¨×•×ª, ×“×•×¨×© ××›×©×™×¨×™× ×œ×ª×œ××™×“×™×, ×ª×œ×•×™ ×‘×—×™×‘×•×¨ ××™× ×˜×¨× ×˜',
    advantages: '××¢×•×¨×¨ ×¢× ×™×™×Ÿ ×•××•×˜×™×‘×¦×™×”, ×§×œ ×œ×™×¦×™×¨×”, ××ª××™× ×œ×›×™×ª×•×ª ×’×“×•×œ×•×ª, × ×ª×•× ×™× ××™×™×“×™×™×',
    disadvantages: '×“×•×¨×© ××›×©×™×¨×™× ×œ×›×œ ×ª×œ××™×“, ×œ× ××ª××™× ×œ×›×œ ×¡×•×’×™ ×”×ª×•×›×Ÿ, ×™×›×•×œ ×œ×”×™×•×ª ××¡×™×— ×“×¢×ª',
    usageInTeaching: '×”×¢×¨×›×” ××¢×¦×‘×ª, ×—×–×¨×” ×¢×œ ×—×•××¨, ×”×¤×¢×œ×ª ×”×›×™×ª×”, ×‘×“×™×§×ª ×”×‘× ×” ××™×™×“×™×ª',
    toolRating: 4.7,
    difficultyLevel: '×§×œ',
    hebrewSupport: true,
    isFree: true,
    outputType: '×—×™×“×•×Ÿ ××™× ×˜×¨××§×˜×™×‘×™',
    communicationFormat: '××©×—×§ ××§×•×•×Ÿ',
    tags: ['×—×™×“×•× ×™×', '××™× ×˜×¨××§×˜×™×‘×™', '×”×¢×¨×›×”', '××©×—×§', '××•×˜×™×‘×¦×™×”'],
    pedagogicalContext: ['×ª×¨×’×•×œ', '×”×¢×¨×›×”'],
    createdBy: 'system'
  },
  {
    name: 'Grammarly',
    link: 'https://www.grammarly.com',
    logo: 'âœï¸',
    description: '×›×œ×™ ×œ×‘×“×™×§×” ×•×©×™×¤×•×¨ ×›×ª×™×‘×” ×‘×× ×’×œ×™×ª ×¢× ×‘×™× ×” ××œ××›×•×ª×™×ª ×©××–×”×” ×©×’×™××•×ª ×“×§×“×•×§, ××™×•×ª ×•×¡×’× ×•×Ÿ.',
    limitations: '××ª××—×” ×‘×× ×’×œ×™×ª ×‘×œ×‘×“, ×œ× ×ª××™×“ ××‘×™×Ÿ ×”×§×©×¨, ×™×›×•×œ ×œ×”×¦×™×¢ ×©×™× ×•×™×™× ×œ× ××ª××™××™×',
    advantages: '×©×™×¤×•×¨ ××©××¢×•×ª×™ ×‘×›×ª×™×‘×”, ×”×¡×‘×¨×™× ×‘×¨×•×¨×™×, ×œ××™×“×” ××ª××©×›×ª, ××™× ×˜×’×¨×¦×™×” ×¢× ×›×œ×™× ×¨×‘×™×',
    disadvantages: '×œ× ×ª×•××š ×‘×¢×‘×¨×™×ª, ×“×•×¨×© ×× ×•×™ ×œ×ª×›×•× ×•×ª ××ª×§×“××•×ª, ×œ× ××ª××™× ×œ×›×œ ×¡×’× ×•× ×•×ª ×›×ª×™×‘×”',
    usageInTeaching: '×©×™×¤×•×¨ ×›×ª×™×‘×” ×‘×× ×’×œ×™×ª, ×”×•×¨××ª ×“×§×“×•×§, ×¤×™×ª×•×— ×›×™×©×•×¨×™ ×›×ª×™×‘×” ××§×“××™×ª',
    toolRating: 4.3,
    difficultyLevel: '×§×œ',
    hebrewSupport: false,
    isFree: true,
    outputType: '×”×¦×¢×•×ª ×©×™×¤×•×¨ ×˜×§×¡×˜',
    communicationFormat: '×ª×•×¡×£ ×“×¤×“×¤×Ÿ/××¤×œ×™×§×¦×™×”',
    tags: ['×›×ª×™×‘×”', '×× ×’×œ×™×ª', '×“×§×“×•×§', '××™×•×ª', '×¢×¨×™×›×”'],
    pedagogicalContext: ['×”×§× ×™×”', '×ª×¨×’×•×œ'],
    createdBy: 'system'
  },
  {
    name: 'Quizlet AI',
    link: 'https://quizlet.com',
    logo: 'ğŸ“š',
    description: '×¤×œ×˜×¤×•×¨××” ×œ×™×¦×™×¨×ª ×›×¨×˜×™×¡×™×•×ª ×œ×™××•×“ ×•××©×—×§×™ ×–×™×›×¨×•×Ÿ ×¢× ×‘×™× ×” ××œ××›×•×ª×™×ª ×©×™×•×¦×¨×ª ×ª×•×›×Ÿ ××•×˜×•××˜×™×ª.',
    limitations: '××ª××™× ×‘×¢×™×§×¨ ×œ×©×™× ×•×Ÿ, ×œ× ×œ×›×œ ×¡×•×’×™ ×”×œ××™×“×”, ×“×•×¨×© ×”×§×œ×“×” ×©×œ ×”×ª×•×›×Ÿ',
    advantages: '×™×¢×™×œ ×œ×©×™× ×•×Ÿ, ××’×•×•×Ÿ ×¤×•×¨××˜×™×, ×§×œ ×œ×©×™×ª×•×£, ××¢×§×‘ ××—×¨ ×”×ª×§×“××•×ª',
    disadvantages: '××•×’×‘×œ ×œ×©×™× ×•×Ÿ ×‘×¡×™×¡×™, ×œ× ××ª××™× ×œ×—×©×™×‘×” ×‘×™×§×•×¨×ª×™×ª, ×“×•×¨×© ×”×›× ×” ××•×§×“××ª',
    usageInTeaching: '×©×™× ×•×Ÿ ××•×¦×¨ ××™×œ×™×, ×œ×™××•×“ ×¢×•×‘×“×•×ª, ×—×–×¨×” ×¢×œ ×—×•××¨, ×”×›× ×” ×œ×‘×—×™× ×•×ª',
    toolRating: 4.1,
    difficultyLevel: '×§×œ',
    hebrewSupport: true,
    isFree: true,
    outputType: '×›×¨×˜×™×¡×™×•×ª ×“×™×’×™×˜×œ×™×•×ª',
    communicationFormat: '××¤×œ×™×§×¦×™×”/××ª×¨',
    tags: ['×©×™× ×•×Ÿ', '×›×¨×˜×™×¡×™×•×ª', '×–×™×›×¨×•×Ÿ', '××•×¦×¨ ××™×œ×™×', '×—×–×¨×”'],
    pedagogicalContext: ['×ª×¨×’×•×œ'],
    createdBy: 'system'
  }
];

export async function GET() {
  try {
    console.log('ğŸ”„ ××ª×—×™×œ ××ª×—×•×œ ××¡×“ ×”× ×ª×•× ×™×...');
    
    // ×‘×“×™×§×ª ××©×ª× ×™ ×¡×‘×™×‘×”
    if (!process.env.MONGODB_URI) {
      console.error('âŒ MONGODB_URI ×œ× ××•×’×“×¨');
      return NextResponse.json({
        error: '××©×ª× ×™ ×”×¡×‘×™×‘×” ×œ× ××•×’×“×¨×™× ×›×¨××•×™',
        details: 'MONGODB_URI ×—×¡×¨'
      }, { status: 500 });
    }

    console.log('âœ… ××©×ª× ×™ ×¡×‘×™×‘×” × ××¦××•');
    
    // ×—×™×‘×•×¨ ×œ××¡×“ ×”× ×ª×•× ×™×
    console.log('ğŸ”— ××ª×—×‘×¨ ×œ××¡×“ ×”× ×ª×•× ×™×...');
    await connectToDatabase();
    console.log('âœ… ×—×™×‘×•×¨ ×œ××¡×“ ×”× ×ª×•× ×™× ×”×¦×œ×™×—');
    
    // ×‘×“×™×§×” ×× ×™×© ×›×‘×¨ ×›×œ×™× ×‘××¡×“ ×”× ×ª×•× ×™×
    console.log('ğŸ” ×‘×•×“×§ ×›×œ×™× ×§×™×™××™×...');
    const existingTools = await Tool.countDocuments();
    console.log(`ğŸ“Š × ××¦××• ${existingTools} ×›×œ×™× ×§×™×™××™×`);
    
    if (existingTools > 0) {
      return NextResponse.json({
        message: `××¡×“ ×”× ×ª×•× ×™× ×›×‘×¨ ××›×™×œ ${existingTools} ×›×œ×™×. ×œ× × ×“×¨×© ××ª×—×•×œ.`,
        existingCount: existingTools
      });
    }

    // ××ª×—×•×œ ××¡×“ ×”× ×ª×•× ×™×
    console.log('ğŸ“ ××•×¡×™×£ ×›×œ×™× ×—×“×©×™×...');
    const tools = await Tool.insertMany(seedTools);
    console.log(`âœ… × ×•×¡×¤×• ${tools.length} ×›×œ×™× ×‘×”×¦×œ×—×”`);
    
    return NextResponse.json({
      message: `××¡×“ ×”× ×ª×•× ×™× ××•×ª×—×œ ×‘×”×¦×œ×—×”! × ×•×¡×¤×• ${tools.length} ×›×œ×™×.`,
      tools: tools.map(tool => ({
        id: tool._id,
        name: tool.name,
        logo: tool.logo
      }))
    });
  } catch (error) {
    console.error('âŒ ×©×’×™××” ×‘××ª×—×•×œ ××¡×“ ×”× ×ª×•× ×™×:', error);
    
    // ×¤×™×¨×•×˜ ×”×©×’×™××”
    let errorDetails = '×©×’×™××” ×œ× ×™×“×•×¢×”';
    if (error instanceof Error) {
      errorDetails = error.message;
      console.error('ğŸ“‹ ×¤×¨×˜×™ ×”×©×’×™××”:', error.stack);
    }
    
    return NextResponse.json({
      error: '×©×’×™××” ×‘××ª×—×•×œ ××¡×“ ×”× ×ª×•× ×™×',
      details: errorDetails,
      timestamp: new Date().toISOString()
    }, { status: 500 });
  }
} 